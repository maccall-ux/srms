{% extends "srms/base.html" %} {% block content %}

<div class="container py-5" id='example'>
    <div class="row justify-content-center">
        <div class="col-lg-10">
            <div class="card shadow">
                <div class="card-header text-center bg-dark text-white">
                    <h4><i class="fas fa-graduation-cap"></i> Student Result Details</h4>
                </div>
                <div class="card-body p-4">

                    {% if messages %}

                    {% for message in messages %}
                    <div class="alert alert-{% if message.tags == 'error' %}danger{% else %}{{message.tags}}{% endif %}alert-dismissible fade show role='alert'">
                        {{message}}
                        <button type="button" class=' btn btn-close' data-bs-dismiss='alert'></button>
                    </div>
                    {% endfor %}

                    {% endif %}


                    <p><strong>Student Name:</strong> {{student.name}}</p>
                    <p><strong>Registration no.:</strong> {{student.reg_no}}</p>
                    <p><strong>Class:</strong> {{student.student_class.class_name}} ({{student.student_class.section}})</p>

                    {% if results %}
                    <table class="table table-bordered mt-4 text-center">
                        <thead>
                            <tr>
                                <th>#</th>
                                <th>Subjects</th>
                                <th>marks</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for result in results %}
                            <tr>
                                <td>{{forloop.counter}}</td>
                                <td>{{result.subject.subject_name}}</td>
                                <td>{{result.marks}}</td>
                            </tr>
                            {% endfor %}
                            <tr>
                                <th colspan='2'>Total marks</th>
                                <td><b>{{total_marks}}</b> out of <b>{{max_total}}</b></td>
                            </tr>
                            <tr>
                                <th colspan='2'>Percentage</th>
                                <td><b>{{percentage}}%</b></td>
                            </tr>
                        </tbody>
                        <tr>
                            <td colspan='3'>
                                <i class='fas fa-print fa-2x' style='cursor: pointer;' onclick='printResult()'></i>
                            </td>
                        </tr>
                    </table>
                    {% else %}
                    <div class="alert alert-warning">Your result is not declared.</div>
                    {% endif %}

                </div>
            </div>
        </div>
    </div>
</div>

<script>
    function printResult() {
        var content = document.getElementById('example').innerHTML;
        var win = window.open('', '', 'height=700,width=900');
        win.document.write('<html><head><title>Print Result</title>');
            win.document.write('{% load django_bootstrap5 %}{% bootstrap_css %}');
            win.document.write('<style>@media print {body {-webkit-print-color-adjust : exact;}}</style>')
            win.document.write('</head><body>');
                win.document.write(content);
                win.document.write('</body></html>');
                win.document.close();
                win.print();
    }
</script>

{% endblock content %}